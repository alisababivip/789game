var L=Object.defineProperty,A=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var S=(n,e,t)=>e in n?L(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,O=(n,e)=>{for(var t in e||(e={}))P.call(e,t)&&S(n,t,e[t]);if(I)for(var t of I(e))v.call(e,t)&&S(n,t,e[t]);return n},k=(n,e)=>A(n,C(e));var r=(n,e,t)=>new Promise((i,a)=>{var o=l=>{try{m(t.next(l))}catch(g){a(g)}},c=l=>{try{m(t.throw(l))}catch(g){a(g)}},m=l=>l.done?i(l.value):Promise.resolve(l.value).then(o,c);m((t=t.apply(n,e)).next())});import{c as M,p as w}from"./store-2ed2b91e.js";import{g as $,o as j,b as W}from"./solid-js-559c9ced.js";import{a1 as p,k as B,m as d,n as R}from"./manifest-0db0cc1f.js";const T=p.Reader,E=p.Writer,b=p.util,y=p.roots.betLog||(p.roots.betLog={});y.BetLog=(()=>{function n(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return n.prototype.userId=b.Long?b.Long.fromBits(0,0,!1):0,n.prototype.nickName="",n.prototype.gameName="",n.prototype.nonce=0,n.prototype.currencyName="",n.prototype.betAmount="",n.prototype.winAmount="",n.prototype.odds=0,n.prototype.betTime=b.Long?b.Long.fromBits(0,0,!1):0,n.prototype.distributeId=b.Long?b.Long.fromBits(0,0,!1):0,n.prototype.type="",n.prototype.oddsString="",n.encode=function(t,i){return i||(i=E.create()),t.userId!=null&&Object.hasOwnProperty.call(t,"userId")&&i.uint32(16).sint64(t.userId),t.nickName!=null&&Object.hasOwnProperty.call(t,"nickName")&&i.uint32(26).string(t.nickName),t.gameName!=null&&Object.hasOwnProperty.call(t,"gameName")&&i.uint32(34).string(t.gameName),t.nonce!=null&&Object.hasOwnProperty.call(t,"nonce")&&i.uint32(40).sint32(t.nonce),t.currencyName!=null&&Object.hasOwnProperty.call(t,"currencyName")&&i.uint32(50).string(t.currencyName),t.betAmount!=null&&Object.hasOwnProperty.call(t,"betAmount")&&i.uint32(58).string(t.betAmount),t.winAmount!=null&&Object.hasOwnProperty.call(t,"winAmount")&&i.uint32(66).string(t.winAmount),t.odds!=null&&Object.hasOwnProperty.call(t,"odds")&&i.uint32(72).sint32(t.odds),t.betTime!=null&&Object.hasOwnProperty.call(t,"betTime")&&i.uint32(80).sint64(t.betTime),t.distributeId!=null&&Object.hasOwnProperty.call(t,"distributeId")&&i.uint32(96).sint64(t.distributeId),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(106).string(t.type),t.oddsString!=null&&Object.hasOwnProperty.call(t,"oddsString")&&i.uint32(114).string(t.oddsString),i},n.decode=function(t,i){t instanceof T||(t=T.create(t));let a=i===void 0?t.len:t.pos+i,o=new y.BetLog;for(;t.pos<a;){let c=t.uint32();switch(c>>>3){case 2:o.userId=t.sint64();break;case 3:o.nickName=t.string();break;case 4:o.gameName=t.string();break;case 5:o.nonce=t.sint32();break;case 6:o.currencyName=t.string();break;case 7:o.betAmount=t.string();break;case 8:o.winAmount=t.string();break;case 9:o.odds=t.sint32();break;case 10:o.betTime=t.sint64();break;case 12:o.distributeId=t.sint64();break;case 13:o.type=t.string();break;case 14:o.oddsString=t.string();break;default:t.skipType(c&7);break}}return o},n})();const u=B(),z={interval:"1h",summary:{vol:0,tvl:0,fees:0},wsPrice:{price:0,time:0,trend:0,high:0,low:0,open:0,liveTime:0},trades:{my:[],public:[]},bets:{my:[],public:[]},supports:{buyCurrency:[],sellCurrency:[]}},[f,s]=M(z),D=f;function G(n){return u.post("/bctrade/forward/api/coin/trade/buyByAmount",n)}function U(n){return u.post("/bctrade/forward/api/coin/trade/sell",n)}const N="/activity/anniversary2024";function F(){return r(this,null,function*(){return yield u.get(`${N}/dollarWin/info/`)})}function K(n,e){return r(this,null,function*(){return yield u.post(`${N}/dollarWin/buyTicket/${n}?currency=${e}`)})}function Q(){return r(this,null,function*(){return yield u.get(`${N}/dollarWin/list?page=1&pageSize=100`)})}function V(){return r(this,null,function*(){return yield u.get("/vault/amount/list/")})}function X(){return r(this,null,function*(){const n=yield u.get("/bctrade/forward/api/coin/trade/myTrade/list?page=1&pageSize=30");s("trades","my",n.items)})}function Y(){return r(this,null,function*(){const n=yield u.get("/bctrade/forward/api/coin/trade/allTrade/list?page=1&pageSize=30");s("trades","public",n.items)})}function Z(){return r(this,null,function*(){const n=yield u.post("/game/bet/bc/recent-bet/",{});s("bets","my",n)})}function _(){return r(this,null,function*(){const n=yield u.get("/game/bet/bc/all-bet/");s("bets","public",n)})}function tt(){return r(this,null,function*(){const n=yield B().get("/bctrade/support-currency");s("supports",n)})}let h=!1;const nt=()=>(h=!0,()=>h=!1);function et(){return r(this,null,function*(){const n=yield u.get("/bctrade/forward/api/coin/token/info");s("summary",n)})}function ot(n){s("interval",n)}function it(){$(()=>{const n=d(),e=d("/bctrade-coin"),t=n.encode("utf8")("COIN/MSG/PUSH"),i=d().decodeBind(a=>{if(a.cmd==="COIN/PRICE"){const o=JSON.parse(a.data);if(o.i!=="1m"&&o.i!==f.interval)return;s("wsPrice",w(c=>{o.i==="1m"&&(c.price=Number(o.c),c.liveTime=Date.now()),o.i===f.interval&&(c.time=o.t,c.trend=Number(o.p),c.high=Number(o.h),c.low=Number(o.l),c.open=Number(o.o))}))}if(h&&a.cmd==="COIN/TRANSACTION"){const o=JSON.parse(a.data);s("trades",w(c=>{o.userId===R.userId&&(c.my=[o].concat(c.my).slice(0,30)),c.public=[o].concat(c.public).slice(0,30)}))}},"json");e.connect(),e.on("COIN/PRICE",i),e.emit("join",t),j(()=>{e.off("COIN/PRICE",i),e.emit("leave",t),e.disconnect()})})}function ct(){const n=t=>{s("bets","public",[k(O({},t),{distributeId:t.distributeId.toString()})].concat(f.bets.public).slice(0,50))},e=t=>{s("bets","my",[k(O({},t),{distributeId:t.distributeId.toString()})].concat(f.bets.my).slice(0,50))};W(()=>{const t=d("/g/data/bc"),i=d().decodeBind(n,y.BetLog),a=d().decodeBind(e,y.BetLog);t.connect();const o=t.on("allbetlog",i),c=t.on("mybetlog",a);j(()=>{o.off("allbetlog"),c.off("mybetlog"),t.disconnect()})})}export{s as a,ct as b,Z as c,_ as d,ot as e,et as f,X as g,Y as h,tt as i,G as j,U as k,nt as l,Q as m,F as n,V as o,K as p,u as r,D as s,it as u};
