var g=(e,n,l)=>new Promise((s,i)=>{var t=o=>{try{a(l.next(o))}catch(b){i(b)}},d=o=>{try{a(l.throw(o))}catch(b){i(b)}},a=o=>o.done?s(o.value):Promise.resolve(o.value).then(t,d);a((l=l.apply(e,n)).next())});import{b as f,G as P,I as S,c as h,a5 as $,B as C,P as D,e as y,a3 as z,p as E,s as _,an as F,_ as N,i as H}from"./manifest-04ceac01.js";import{o as L,F as I,b as v,S as p,a as M,h as A,d as B}from"./solid-js-9bdbdf5e.js";import{h as T,i as c,c as r,e as m,b as w,a as u,t as x,j as U}from"./i18n-98ba7270.js";import{b as V}from"./router-64ab6322.js";var j=u('<div class="flex h-100 w-full overflow-hidden bg-white_alpha5"><div class="w-1/4 flex-none"></div><div class="relative h-full flex-1 bg-layer2"><div class="flec center h-[338px] w-full"></div><div class="absolute left-0 top-0 h-[338px] w-full overflow-hidden"></div><div class="mt-2.5 px-4">'),q=u('<div><p class="w-5/6 overflow-hidden text-ellipsis whitespace-nowrap">');function G(e){return L(()=>{f.emit("sensorsTrack",{event:"promotion_banner_show",bannerid:e.select.bannerId})}),(()=>{var n=j(),l=n.firstChild,s=l.nextSibling,i=s.firstChild,t=i.nextSibling,d=t.nextSibling;return c(l,r(P,{class:"h-100",get children(){return r(I,{get each(){return e.promotionsList},children:a=>(()=>{var o=q(),b=o.firstChild;return o.$$click=()=>{e.setSelect(a),f.emit("sensorsTrack",{event:"promotion_banner_show",bannerid:a.bannerId})},c(b,()=>a.title),c(o,r(S,{name:"Arrow",class:"ml-2 size-4 rotate-180 text-secondary"}),null),m(()=>w(o,h("promotion-banner-item flex h-12 w-full cursor-pointer items-center border-b border-solid border-third px-4",e.select.bannerId===a.bannerId&&"select-banner"))),o})()})}})),c(i,r($,{})),t.style.setProperty("background-size","100% 100%"),t.style.setProperty("background-repeat","no-repeat"),c(d,r(C,{type:"brand",class:"w-full",onClick:()=>{e.select.buttonLink&&window.open(e.select.buttonLink),f.emit("sensorsTrack",{event:"promotion_button_click",bannerid:e.select.bannerId})},get children(){return e.select.buttonName}})),m(a=>(a=`url(${e.select.bannerUrl})`)!=null?t.style.setProperty("background-image",a):t.style.removeProperty("background-image")),n})()}T(["click"]);var k=u("<div>"),Q=u('<div class="relative flex h-12 w-full"><div class="flex h-full w-full items-center px-3 bg-layer2"><div class="flex-auto truncate"></div> '),R=u('<div class="w-full bg-white_alpha5"><div class="relative h-full flex-1 bg-layer2 pb-4"><div class="flec center h-60 w-full bg-layer3"></div><div class="absolute left-0 top-0 h-60 w-full overflow-hidden"></div><div class="mt-4 px-4">');function J(e){const[n,l]=v(!1);return(()=>{var s=Q(),i=s.firstChild,t=i.firstChild;return t.nextSibling,s.$$click=()=>l(d=>!d),c(t,()=>e.select.title),c(i,r(S,{get class(){return h("size-4 flex-none -rotate-180 transition-all",n()&&"!-rotate-90")},name:"Arrow"}),null),c(s,r(p,{get when(){return n()},get children(){var d=k();return c(d,r(P,{class:"h-full",get children(){return r(I,{get each(){return e.promotionsList},children:a=>(()=>{var o=k();return o.$$click=()=>e.setSelect(a),c(o,()=>a.title),m(()=>w(o,h("h-12 items-center self-stretch truncate border-t border-third px-3 leading-10 py-1",e.select===a&&"dark:bg-[#293F35] bg-[#D3E9E0]"))),o})()})}})),m(()=>w(d,h("absolute left-0 top-12 z-10 h-36 w-full rounded-b-xl bg-layer1"))),d}}),null),s})()}function K(e){return L(()=>{f.emit("sensorsTrack",{event:"promotion_banner_show",bannerid:e.select.bannerId})}),(()=>{var n=R(),l=n.firstChild,s=l.firstChild,i=s.nextSibling,t=i.nextSibling;return c(n,r(J,e),l),c(s,r($,{})),i.style.setProperty("background-position","center"),i.style.setProperty("background-size","cover"),c(t,r(C,{type:"brand",class:"w-full",onClick:()=>{e.select.buttonLink&&window.open(e.select.buttonLink),f.emit("sensorsTrack",{event:"promotion_button_click",bannerid:e.select.bannerId})},get children(){return e.select.buttonName}})),m(d=>(d=`url(${e.select.bannerUrl})`)!=null?i.style.setProperty("background-image",d):i.style.removeProperty("background-image")),n})()}T(["click"]);var O=u('<div class="flex h-10 items-center overflow-hidden bg-layer4 pl-4"><span>'),W=u('<div class="center flex size-full bg-layer4">'),X=u('<div class="center flex h-60 w-full">');function Y(e){const[n,l]=v(!1),[s,i]=v(e.promotionsList[0]);return M(()=>{n()&&window.localStorage.setItem("hidden-promotions-one-day",String(Date.now()))}),r(D,{get title(){return(()=>{var t=W();return t.style.setProperty("border-top-left-radius","0.75rem"),t.style.setProperty("border-top-right-radius","0.75rem"),c(t,()=>x("Exclusive Promotions")),t})()},class:"promotion-popup w-full lg:w-[800px] lg:pt-12",get children(){return r(p,{get when(){return e.promotionsList.length>0},get fallback(){return(()=>{var t=X();return c(t,r($,{})),t})()},get children(){return[r(p,{get when(){return y.mobile},get fallback(){return r(G,{get promotionsList(){return e.promotionsList},get select(){return s()},setSelect:i})},get children(){return r(K,{get promotionsList(){return e.promotionsList},get select(){return s()},setSelect:i})}}),(()=>{var t=O(),d=t.firstChild;return c(t,r(z,{get value(){return n()},onChange:l}),d),c(d,()=>x("Donâ€™t display this for next 1 day")),m(a=>U(t,y.mobile?void 0:{"border-bottom-left-radius":"0.75rem","border-bottom-right-radius":"0.75rem"},a)),t})()]}})}})}function Z(e){return g(this,null,function*(){return E.push(()=>r(Y,{promotionsList:e}),{close:!1})})}function ee(){return g(this,null,function*(){try{return(yield N().get(`/home/main/pop/banner/${H.areaCode}/`)).sort((n,l)=>l.startTime-n.startTime)}catch(e){return console.error("Failed to fetch IPL condition:",e),[]}})}const ie=()=>{const e=V(),l=["/",`/${_.lang}`,`/${_.lang}/`].includes(e.pathname),[s]=A(()=>l&&te(),ee,{initialValue:[]});B(()=>{s().length>0&&setTimeout(()=>{F.add(()=>Z(s()))},4e3)})};function te(){const e=window.localStorage.getItem("hidden-promotions-one-day");return e?Date.now()-Number(e)>864e5:!0}export{ie as default,ie as schedulePromotions};
