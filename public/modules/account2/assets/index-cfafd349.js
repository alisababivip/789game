var G=Object.defineProperty;var I=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var H=(r,e,t)=>e in r?G(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,D=(r,e)=>{for(var t in e||(e={}))K.call(e,t)&&H(r,t,e[t]);if(I)for(var t of I(e))q.call(e,t)&&H(r,t,e[t]);return r};var T=(r,e,t)=>new Promise((g,n)=>{var i=c=>{try{f(t.next(c))}catch(w){n(w)}},v=c=>{try{f(t.throw(c))}catch(w){n(w)}},f=c=>c.done?g(c.value):Promise.resolve(c.value).then(i,v);f((t=t.apply(r,e)).next())});import{c as l,i as a,m as F,t as _,a as m,e as L,f as Q,s as $}from"./i18n-c89f3d65.js";import{a as N,S as u,f as V}from"./solid-js-c760dca1.js";import{g as z,f as X,t as Y,B as C,i as O,u as j,c as B,e as h,m as y,a as P,h as k,N as Z,b as ee,D as E}from"./manifest-085c1252.js";import{T as R}from"./ThirdLogin-3b3670ba.js";import{a as te,e as M}from"./utils-fc815858.js";import{u as le,a as b}from"./ctx-e35816a7.js";import{A as se}from"./Icon-d970f300.js";import{i as ne,b as U,r as ae,a as ie,c as x}from"./utils-de8488f6.js";import{u as re}from"./router-5e0daa1f.js";function oe(r,e){return T(this,null,function*(){try{ne()||(yield te());let t=yield z().post("/account/passkey/get_auth_challenge_for_login/",{});const g=t.sessionId||"";if(t){if(delete t.sessionId,t.challenge=U(t.challenge),t.allowCredentials instanceof Array)for(let i of t.allowCredentials)"id"in i&&(i.id=U(i.id));ae(t)}const n=yield navigator.credentials.get({publicKey:t,signal:ie});if(n){let i={rawId:x(n.rawId),id:x(n.rawId),response:{clientDataJSON:x(n.response.clientDataJSON),userHandle:x(n.response.userHandle),signature:x(n.response.signature),authenticatorData:x(n.response.authenticatorData)},type:n.type};n.getClientExtensionResults&&(i.extensions=n.getClientExtensionResults()),yield z().post("/account/passkey/login/",D({sessionId:g},i)),X.emit("signin-success"),r()}}catch(t){e&&e(),Y(t)}})}var ce=m('<span class="text-primary ml-2 font-extrabold">');const J=function(e){const t=le();return l(C,{get class(){return O("w-full mt-3 -mb-3 h-10 border border-third",e.class)},onClick:()=>oe(()=>{e.class&&b.onChange("redirect","/settings/passkey-change-password"),t()}),get children(){return[l(se,{name:"Passkey",class:"size-5 text-secondary",viewBox:"0 0 20 20"}),(()=>{var g=ce();return a(g,(()=>{var n=F(()=>!!e.class);return()=>n()?_("Reset by Passkey"):_("Sign In with passkey")})()),g})()]}})};var ge=m(`<div><p class="text-4xl font-extrabold text-center w-full whitespace-nowrap overflow-hidden"></p><p class="mt-1 mb-[104px] w-full text-center whitespace-nowrap overflow-hidden font-semibold text-base'">`),ue=m('<p class="text-lg font-extrabold">'),de=m('<div class="w-full h-4 flex items-center"><div class="flex-1 h-[1px] bg-third"></div><p class="mx-3 flex-none text-secondary"></p><div class="flex-1 h-[1px] bg-third">'),he=m('<div class="w-full px-6 absolute bottom-5 left-0">'),fe=m('<div class="bg-layer2 size-full flex !mb-0 absolute inset-x-0 inset-y-0"><div class="relative w-1/2 flex-none h-full"><img alt=top-img class="w-full h-full"><img alt=logo class="w-auto h-8 absolute top-4 left-6"></div><div class="w-1/2 flex-none h-full px-6 py-5 relative"><div class="w-full h-8 flex items-center justify-between">');const W=function(e){const t=j(),{isUsHost:g}=B.getHostType(h.host),{state:n}=b,i=N(()=>M(y.lang,h.host));return(()=>{var v=fe(),f=v.firstChild,c=f.firstChild,w=c.nextSibling,p=f.nextSibling,S=p.firstChild;return a(f,l(u,{get when(){return!i().hideText},get children(){var s=ge(),o=s.firstChild,d=o.nextSibling;return a(o,()=>_("Stay Untamed")),a(d,()=>_("Sign Up & Get Welcome Bonus")),L(()=>Q(s,O("absolute bottom-0 left-0 w-full",i().center&&"bottom-16"))),s}}),null),a(S,l(u,{get when(){return e.title()},get fallback(){return l(C,{class:"size-8 center bg-white_alpha5 rounded-lg",onClick:()=>t(-1),get children(){return l(P,{class:"fill-secondary",name:"Arrow"})}})},get children(){return[(()=>{var s=ue();return a(s,()=>e.title()),s})(),l(u,{get when(){return!n.auth},get children(){return l(C,{class:"size-8 center bg-white_alpha5 rounded-lg",onClick:()=>t(-1),get children(){return l(P,{class:"fill-secondary",name:"Close"})}})}})]}})),a(p,()=>e.children,null),a(p,l(u,{get when(){return!e.noThird},get children(){var s=he();return a(s,l(u,{when:!g,get children(){var o=de(),d=o.firstChild,A=d.nextSibling;return a(A,()=>_("Log in directly with")),o}}),null),a(s,l(u,{get when(){return e.signin},get children(){return l(J,{})}}),null),a(s,l(R,{}),null),s}}),null),L(s=>{var o=y.darken?i().imgAssets.bg:i().imgAssets.bg_w,d=y.darken?k.assets(h.inActive?"/logo/logo_festival.png":"/logo/logo.png"):k.assets(h.inActive?"/logo/logo_w_festival.png":"/logo/logo_w.png");return o!==s.e&&$(c,"src",s.e=o),d!==s.t&&$(w,"src",s.t=d),s},{e:void 0,t:void 0}),v})()};var me=m('<div class="w-full h-4 flex items-center"><div class="flex-1 h-[1px] bg-third"></div><p class="mx-3 flex-none text-secondary"></p><div class="flex-1 h-[1px] bg-third">'),ve=m('<div class="w-full px-6 pb-5 pt-8">'),we=m('<div class="h-full flex-none"><div class="w-full pt-st relative h-60 box-content"><img alt=top-img class="w-full overflow-hidden absolute bottom-2 left-0"><div class="w-full z-10 absolute left-0 bottom-44 flex items-center justify-between p-4 pb-5"><img alt=logo class="w-auto h-8"></div></div><div class="w-full flex-1 px-6 relative z-10"><p class="text-lg font-extrabold h-5 flex items-center">');const be=function(e){const t=j(),{isUsHost:g}=B.getHostType(h.host),n=N(()=>M(y.lang,h.host));return(()=>{var i=we(),v=i.firstChild,f=v.firstChild,c=f.nextSibling,w=c.firstChild,p=v.nextSibling,S=p.firstChild;return a(c,l(u,{get when(){return!b.state.auth},get children(){return l(C,{class:"size-8 center bg-white_alpha5 rounded-lg",onClick:()=>t(-1),get children(){return l(P,{class:"fill-secondary",name:"Close"})}})}}),null),a(S,()=>e.title()),a(p,()=>e.children,null),a(i,l(u,{get when(){return!e.noThird},get children(){var s=ve();return a(s,l(u,{when:!g,get children(){var o=me(),d=o.firstChild,A=d.nextSibling;return a(A,()=>_("Log in directly with")),o}}),null),a(s,l(u,{get when(){return e.signin},get children(){return l(J,{})}}),null),a(s,l(R,{}),null),s}}),null),L(s=>{var o=y.darken?n().imgAssets.bg_m:n().imgAssets.bg_m_w,d=y.darken?k.assets(h.inActive?"/logo/logo_festival.png":"/logo/logo.png"):k.assets(h.inActive?"/logo/logo_w_festival.png":"/logo/logo_w.png");return o!==s.e&&$(f,"src",s.e=o),d!==s.t&&$(w,"src",s.t=d),s},{e:void 0,t:void 0}),i})()},Pe=function(e){const t=Z(),[g]=re(),n=ee();return V(()=>{n()&&(b.state.prePathname?b.onChange({prePathname:t()||"/"}):b.onChange({redirect:g.redirect,tgOneclick:h.initHashParams.includes("tgWebAppData"),prePathname:b.state.prePathname||t()||"/"}))}),l(u,{get when(){return h.mobile},get fallback(){return l(W,e)},get children(){return l(be,e)}})},Ie=function(e){return l(u,{get when(){return h.mobile},get fallback(){return l(E,{class:"pc-no-layout",get children(){return l(W,{title:()=>e.title||"",noThird:!0,get children(){return e.children}})}})},get children(){return l(E,{get children(){return e.children}})}})};export{Pe as L,J as P,Ie as a,oe as p};
