var w=(P,s,e)=>new Promise((m,n)=>{var i=r=>{try{l(e.next(r))}catch(c){n(c)}},p=r=>{try{l(e.throw(r))}catch(c){n(c)}},l=r=>r.done?m(r.value):Promise.resolve(r.value).then(i,p);l((e=e.apply(P,s)).next())});import{c as o,t as d,i as u,a as g}from"./i18n-c89f3d65.js";import{c as v,e as L,S as b}from"./solid-js-c760dca1.js";import{u as x,c as O,e as R,d as S,D as T,B as k,L as A,A as E,a as B,r as C,t as h}from"./manifest-085c1252.js";import{L as D,P as F}from"./index-cfafd349.js";import{a as I}from"./ctx-e35816a7.js";import{a as _}from"./api-714394ad.js";import{g as y,c as H}from"./utils-fc815858.js";import{E as V}from"./EmailPhoneInput-81b67b30.js";import"./ThirdLogin-3b3670ba.js";import"./store-53c53def.js";import"./UnableLogin-e0a40924.js";import"./toInteger-d3049371.js";import"./toNumber-2a781ab2.js";import"./isObject-010a5422.js";import"./isObjectLike-e68f0fe0.js";import"./Icon-3c4242d7.js";import"./Icon-d970f300.js";import"./utils-de8488f6.js";import"./_MapCache-b362f000.js";import"./router-5e0daa1f.js";import"./md5-771285ef.js";import"./___vite-browser-external_commonjs-proxy-f1a149ad.js";import"./hmac-sha256-ab7884e0.js";var j=g("<form>"),q=g("<span class=ml-1>"),z=g('<div class="mt-4 w-full">'),G=g("<span>");const K=/^\+*\d{3,}$/,ge=function(){const s=x(),{state:e,onChange:m}=I,[n,i]=v(!1),[p,l]=v(0),{isKenyaHost:r}=O.getHostType(R.host),c=a=>w(this,null,function*(){if(a.preventDefault(),n()||!e.emailOrPhone)return!1;if(i(!0),K.test(e.emailOrPhone))$();else try{const f=yield C("reset_password");_.handleResetPassword(e.emailOrPhone,f).then(()=>{h.success(d("Email sent successfully. Please check your email to reset your password.")),s(y("/login/signin",e.auth),{replace:!0})}).catch(h),i(!1)}catch(f){h(f)}}),$=()=>w(this,null,function*(){const a=H(e.areaCode.areaCode,e.emailOrPhone);try{const t=yield C("reset_password");yield _.handleGetPhoneCaptcha({captchaType:"reset_password",code:t,invitationCode:e.invitationCode,phone:`(+${a.areaCode})${a.phone}`,resend:p()>0},!1),l(p()+1),s(y("/login/phone/reset-password",e.auth),{replace:!0})}catch(t){t&&h(t)}i(!1)});return L(()=>{S.login&&s(-1)}),o(T,{class:"w-full account-dialog",get children(){return o(D,{noThird:!0,title:()=>d("Reset Password"),get children(){return[(()=>{var a=j();return a.addEventListener("submit",c),u(a,o(V,{get value(){return e.emailOrPhone},setValue:t=>m({emailOrPhone:t}),get areaCode(){return e.areaCode},get areaCodes(){return e.areaCodes},setAreaCode:t=>m({areaCode:t}),inputType:r?"phone":"auto"}),null),u(a,o(k,{type:"brand",class:"w-full mt-4",submit:!0,get children(){return o(b,{get when(){return n()},get fallback(){return(()=>{var t=G();return u(t,()=>d("Reset Password")),t})()},get children(){return o(A,{class:"!text-alw_white"})}})}}),null),a})(),o(F,{class:"!mb-0"}),(()=>{var a=z();return u(a,o(E,{get href(){return y("/login/signin",e.auth)},replace:!0,class:"ml-2 font-extrabold text-secondary text-center flex items-center w-full justify-center",get children(){return[o(B,{name:"Arrow",class:"size-4.5"}),(()=>{var t=q();return u(t,()=>d("Back to Login")),t})()]}})),a})()]}})}})};export{ge as default};
