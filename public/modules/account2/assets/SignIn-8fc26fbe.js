var y=(f,i,t)=>new Promise((o,m)=>{var r=c=>{try{h(t.next(c))}catch(_){m(_)}},p=c=>{try{h(t.throw(c))}catch(_){m(_)}},h=c=>c.done?o(c.value):Promise.resolve(c.value).then(r,p);h((t=t.apply(f,i)).next())});import{i as s,c as e,t as a,a as u,T as W,m as te,d as re,s as D}from"./i18n-c89f3d65.js";import{c as v,S as C,b as ne,a as ae,F as se,o as oe,d as ie,e as le,f as N}from"./solid-js-c760dca1.js";import{B as $,r as I,g as F,t as k,I as ce,P as X,a as ue,p as x,e as O,u as de,b as me,c as pe,d as fe,f as R,D as ge,A as M,L as he,h as U}from"./manifest-085c1252.js";import{p as ye,L as ve}from"./index-cfafd349.js";import{g as V,i as $e,a as _e}from"./utils-fc815858.js";import{a as j}from"./api-714394ad.js";import{U as be}from"./UnableLogin-e0a40924.js";import{i as we,u as J,a as L}from"./ctx-e35816a7.js";import{E as Q}from"./EmailPhoneInput-81b67b30.js";import{P as Ce}from"./PasswordInput-4a5a5453.js";import{i as xe}from"./utils-de8488f6.js";import{L as Se}from"./Icon-3c4242d7.js";import{A as P}from"./Icon-d970f300.js";import{P as H}from"./PasteInput-3d046803.js";import{R as Z}from"./Resend-1e4ad7c3.js";import{p as Pe}from"./store-37111ab8.js";import{p as Te,s as ke}from"./passkey-9aca49bf.js";import"./ThirdLogin-3b3670ba.js";import"./store-53c53def.js";import"./router-5e0daa1f.js";import"./md5-771285ef.js";import"./___vite-browser-external_commonjs-proxy-f1a149ad.js";import"./hmac-sha256-ab7884e0.js";import"./toInteger-d3049371.js";import"./toNumber-2a781ab2.js";import"./isObject-010a5422.js";import"./isObjectLike-e68f0fe0.js";import"./_MapCache-b362f000.js";import"./Countdown-083af6d7.js";var Ve=u('<p class="ml-1 font-extrabold">'),Ee=u("<p class=ml-1>"),Ae=u("<div class=w-full>");const Le=function(i){return(()=>{var t=Ae();return s(t,e($,{class:"w-full mt-3",type:"brand",onClick:()=>we(i.loginSuccess),get children(){return[e(Se,{name:"Telegram",class:"size-4"}),(()=>{var o=Ve();return s(o,()=>a("One-click Sign in")),o})()]}}),null),s(t,e($,{class:"w-full mt-3",type:"second",onClick:()=>i.onChange(!1),get children(){var o=Ee();return s(o,()=>a("Sign in with ID & password")),o}}),null),t})()};var Oe=u('<div class="flex items-center justify-center">'),Ie=u('<p class="mt-3 text-secondary px-2 text-center">'),Fe=u('<p class="input-label mt-5">');const He=function(i){const[t,o]=v(""),m=()=>{i.onSubmit({type:"google_2fa",code:t()})};return[(()=>{var r=Oe();return s(r,e(P,{name:"TwoFactor",class:"size-8 text-secondary"})),r})(),(()=>{var r=Ie();return s(r,()=>a("Enter the code generated by your Google Authenticator App.")),r})(),(()=>{var r=Fe();return s(r,()=>a("Verification Code")),r})(),e(H,{get value(){return t()},setValue:o,get placeholder(){return a("6-digit verification code")},submitFn:m}),e($,{type:"brand",class:"w-full mt-4 h-12",get disabled(){return t().length!==6},onClick:()=>t().length===6&&m(),get children(){return a("Confirm")}})]};var B=u('<div class="flex items-center justify-center">'),K=u('<p class="mt-3 text-secondary px-2 text-center">'),ze=u('<span class="ml-1 text-primary font-semibold block">__phone__'),De=u('<p class="input-label mt-5">'),Ne=u("<div class=center>");const Re=function(i){const{state:t,setState:o}=Pe,[m,r]=v(0),[p,h]=v(0),[c,_]=v(""),b=()=>y(this,null,function*(){const l=yield I("phone");yield F().post("/account/phone/captcha/",{phone:`(+${t.areaCode.areaCode})${t.phone}`,codeType:"reCAPTCHA",code:l,captchaType:"common_verify",resend:m()>0})}),d=()=>y(this,null,function*(){try{yield b(),ne(()=>{h(1),r(1)})}catch(l){k(l)}}),T=()=>y(this,null,function*(){i.onSubmit({type:"phone",code:c()})});return e(C,{get when(){return p()===0},get fallback(){return[(()=>{var l=B();return s(l,e(P,{name:"Phone",class:"size-8 text-secondary"})),l})(),(()=>{var l=K();return s(l,e(W,{i18nKey:"account2.setting.send.code.phone",get phone(){return`(+${t.areaCode.areaCode}) ${t.phone}`},get children(){return["Please enter the 6-digit verification code sent to",ze()]}})),l})(),(()=>{var l=De();return s(l,()=>a("Verification Code")),l})(),e(H,{get value(){return c()},setValue:_,get placeholder(){return a("6-digit verification code")},submitFn:T}),(()=>{var l=Ne();return s(l,e(Z,{sendAction:b,time:59e3,class:"mt-3 text-secondary"})),l})(),e($,{type:"brand",class:"w-full mt-4 h-12",get disabled(){return c().length!==6},onClick:()=>{if(c()&&c().length===6)return T()},get children(){return a("Confirm")}})]},get children(){return[(()=>{var l=B();return s(l,e(P,{name:"Phone",class:"size-8 text-secondary"})),l})(),(()=>{var l=K();return s(l,()=>a("Please enter and verify your phone below.")),l})(),e(C,{get when(){return t.areaCodeList.length>0},get children(){return e(Q,{get value(){return t.phone},setValue:l=>o({phone:l}),get areaCode(){return t.areaCode},get areaCodes(){return t.areaCodeList},setAreaCode:l=>o({areaCode:l}),get placeholderText(){return a("Your phone number")},class:"mt-3",inputType:"phone"})}}),e($,{class:"w-full mt-6",type:"brand",get disabled(){return!t.phone},onClick:d,get children(){return a("Verify")}})]}})};var G=u('<div class="flex items-center justify-center">'),Y=u('<p class="mt-3 text-secondary px-2 text-center">'),Me=u('<span class="ml-1 text-primary font-semibold block">__email__'),Ue=u('<p class="input-label mt-5">'),je=u("<div class=center>");const Be=function(i){const[t,o]=v(0),[m,r]=v(""),[p,h]=v(""),c=()=>y(this,null,function*(){const d=yield I("email");yield F().post("/account/verify/email/login-fail/send/",{email:m(),codeType:"reCAPTCHA",code:d})}),_=()=>y(this,null,function*(){try{yield c(),o(1)}catch(d){k(d)}}),b=()=>y(this,null,function*(){i.onSubmit({type:"email",code:p()})});return e(C,{get when(){return t()===0},get fallback(){return[(()=>{var d=G();return s(d,e(P,{name:"Email",class:"size-8 text-secondary"})),d})(),(()=>{var d=Y();return s(d,e(W,{i18nKey:"account2.setting.send.code.email",get email(){return m()},get children(){return["Please enter the 6-digit verification code sent to",Me()]}})),d})(),(()=>{var d=Ue();return s(d,()=>a("Verification Code")),d})(),e(H,{get value(){return p()},setValue:h,get placeholder(){return a("6-digit verification code")},submitFn:b}),(()=>{var d=je();return s(d,e(Z,{sendAction:c,time:59e3,class:"mt-3 text-secondary"})),d})(),e($,{type:"brand",class:"w-full mt-4 h-12",get disabled(){return p().length!==6},onClick:()=>{if(p()&&p().length===6)return b()},get children(){return a("Confirm")}})]},get children(){return[(()=>{var d=G();return s(d,e(P,{name:"Email",class:"size-8 text-secondary"})),d})(),(()=>{var d=Y();return s(d,()=>a("Please enter and verify your email below.")),d})(),e(ce,{get value(){return m()},onChange:r,class:"mt-6 w-full h-12"}),e($,{class:"w-full mt-6",type:"brand",get disabled(){return!m()},onClick:_,get children(){return a("Verify")}})]}})};var Ke=u('<p class="my-3 text-secondary px-2 text-center">'),Ge=u("<div class=w-full>"),Ye=u('<span class="text-base font-semibold ml-1">'),qe=u('<span class="text-brand ml-auto font-semibold mr-1">');const We=function(i){const[t,o]=v(-1),m=ae(()=>[{title:()=>a("Email Verification")},{title:()=>a("Phone Verification")},{title:()=>a("Twofa Verification")}]);return e(X,{get title(){return a("Verification")},get children(){var r=Ge();return s(r,e(C,{get when(){return t()<0},get fallback(){return[e(C,{get when(){return t()===0},get children(){return e(Be,{get onSubmit(){return i.onSubmit}})}}),e(C,{get when(){return t()===1},get children(){return e(Re,{get onSubmit(){return i.onSubmit}})}}),e(C,{get when(){return t()===2},get children(){return e(He,{get onSubmit(){return i.onSubmit}})}}),e($,{type:"second",class:"w-full my-4",onClick:()=>o(-1),get children(){return a("Back")}})]},get children(){return[(()=>{var p=Ke();return s(p,()=>a("Please complete the authentication in at least one of the following methods, and you can log in normally after the authentication is passed")),p})(),e(se,{get each(){return m()},children:(p,h)=>e($,{class:"w-full h-14 pl-3 pr-2 justify-start rounded-lg10 bg-tab_nopadding dark:bg-layer5 mb-3",onClick:()=>o(h()),get children(){return[e(P,{get name(){return te(()=>h()===0)()?"Email":h()===1?"Phone":"TwoFactor"},class:"size-5"}),(()=>{var c=Ye();return s(c,()=>p.title()),c})(),(()=>{var c=qe();return s(c,()=>a("Go Verify")),c})(),e(ue,{class:"size-4 text-brand rotate-180",name:"Arrow"})]}})})]}})),r}})};var Xe=u('<div class="flex center w-full"><img alt=passkey class=h-36>'),Je=u('<p class="mt-4 font-semibold text-secondary px-2 text-center">'),Qe=u('<div class="mt-3 flex center w-full"><button class="text-base text-brand font-semibold hover:underline">'),Ze=u('<div class="flex center mb-4 mt-6"><img alt=safeurl class=w-5><p class="ml-2 text-secondary">');const et=function(i){const t=J();return oe(()=>{i.onSubmit([])}),e(X,{get title(){return a("Security Verification Required")},get children(){return[(()=>{var o=Xe(),m=o.firstChild;return D(m,"src",Te),o})(),(()=>{var o=Je();return s(o,()=>a("Your account has been triggered 4 incorrect password attempts within the last 24 hours. For the security of your account, please perform the following verification.")),o})(),e($,{type:"brand",class:"w-full mt-4",onClick:()=>ye(()=>{t(),x.pop()}),get children(){return a("Verify with Passkey")}}),(()=>{var o=Qe(),m=o.firstChild;return m.$$click=()=>y(this,null,function*(){i.onSubmit(void 0),x.pop()}),s(m,()=>a("Use Different Methods to Verify")),o})(),(()=>{var o=Ze(),m=o.firstChild,r=m.nextSibling;return D(m,"src",ke),s(r,()=>a("Protected by __ENV_HOST__")),o})()]}})};re(["click"]);function tt(){return y(this,null,function*(){if(navigator.credentials){const t=yield rt();if(t)return t.length>0?(x.pop(),{code:"passkey",timestamp:String(O.serverTime.getTime()),verifyType:"passkey"}):void 0}const f=yield nt(),i=String(O.serverTime.getTime());if(f)return{code:f.code,timestamp:i,verifyType:f.type}})}function rt(){return new Promise(f=>{x.push(()=>e(et,{onSubmit:i=>f(i)}),{close:!1})})}function nt(f){return y(this,null,function*(){return new Promise(i=>y(this,null,function*(){const t=o=>{i(o),x.pop()};yield x.push(()=>e(We,{onSubmit:t}),{close:!1}),i(null)}))})}var q=u("<span>"),at=u("<form>"),st=u('<div class="flex flex-wrap items-center mt-6 min-h-6"><span class=mr-2>');const ot=/^\+*\d{3,}$/,Nt=function(){const i=de(),t=me(),o=F(),m=J(),{state:r,onChange:p}=L,[h,c]=v(!1),[_,b]=v(!1),[d,T]=v(L.state.tgOneclick);ie(()=>T(L.state.tgOneclick));const{isKenyaHost:l,isBrAuditHost:it}=pe.getHostType(O.host),z=g=>y(this,null,function*(){if(g&&g.preventDefault(),_()||!r.emailOrPhone||!r.password)return!1;b(!0);try{let n={};if(h()){const w=yield tt();if(w&&w.verifyType&&w.code)n={verifyType:w.verifyType,verifyCode:w.code};else{b(!1);return}}const S=$e()?"":yield I("login");xe()||(yield _e());let A;if(ot.test(r.emailOrPhone)){let w=r.emailOrPhone;l&&w.startsWith("0")&&(w=w.substring(1)),A=yield j.handleLoginPhone(`(+${r.areaCode.areaCode})${w}`,r.password,n.verifyCode?n:{},S)}else A=yield j.handleLogin(r.emailOrPhone,r.password,n.verifyCode?n:{},S);A.google2StepAuth?i(V("/login/twofa-verify",r.auth)):E()}catch(n){if(b(!1),!n)return;if(n.code===U.ErrorCode.SELF_EXCLUSION){const S=n.message.split("|").pop();ee(S)}else n.code===U.ErrorCode.REMOTE_LOGIN?i(V(`/login/remote-login/?email=${r.emailOrPhone}`,r.auth)):n.code===6201?(c(!0),k(n)):n.code===6301?(c(!0),k(n),z()):n.code===6202?x.confirm(()=>a("Your account is temporarily unavailable. Please contact our Customer Service team for assistance. recovery@bcgame.com")):k(n);n.code!==6201&&c(!1)}});function E(){R.emit("signin-success"),m()}function ee(g){o.get(`/account/self-exclusion/status/${g}/`).then(n=>{const S=n.startTime+n.period*30*864e5;x.push(()=>e(be,{get startTime(){return n.startTime},get endTime(){return n.period<0?-1:S}}))}).catch(console.log)}return le(()=>{fe.login&&i(-1),R.on("account-signin-verify-success",E)}),N(()=>{t()&&b(!1)}),N(()=>{r.emailOrPhone&&c(!1)}),e(ge,{class:"w-full account-dialog dialog-l",get children(){return e(ve,{title:()=>a("Sign In"),signin:!0,get children(){return e(C,{get when(){return!d()},get fallback(){return e(Le,{onChange:T,loginSuccess:E})},get children(){return[(()=>{var g=at();return g.addEventListener("submit",z),s(g,e(Q,{get value(){return r.emailOrPhone},setValue:n=>p({emailOrPhone:n}),get areaCode(){return r.areaCode},get areaCodes(){return r.areaCodes},setAreaCode:n=>p({areaCode:n}),inputType:l?"phone":"auto"}),null),s(g,e(Ce,{class:"mt-3 bg-input_darken",get password(){return r.password},changePassword:n=>p("password",n),get placeholder(){return a("Password")},hiddenPasswordLevel:!0}),null),s(g,e(M,{get href(){return V("/login/forgot",r.auth)},replace:!0,class:"mt-4 font-extrabold flex justify-end text-secondary",get children(){var n=q();return s(n,()=>a("Forgot your password?")),n}}),null),s(g,e($,{type:"brand",class:"w-full mt-6",submit:!0,get children(){return e(C,{get when(){return _()},get fallback(){return(()=>{var n=q();return s(n,()=>a("Sign In")),n})()},get children(){return e(he,{class:"!text-alw_white"})}})}}),null),g})(),(()=>{var g=st(),n=g.firstChild;return s(n,()=>a("New to __ENV_HOST__?")),s(g,e(M,{get href(){return V("/login/regist",r.auth)},replace:!0,class:"font-extrabold text-brand whitespace-normal break-words",get children(){return a("Create account")}}),null),g})()]}})}})}})};export{Nt as default};
