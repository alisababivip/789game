import"./index-CYisxgcc.js";import{a as o,ag as g,u,b as a,d as n,o as p,e as l}from"./common-CGW8ip2_.js";import"./vendor-DPHX6XRs.js";class m{constructor(t){this._isOpen=!1,this.activeSupport=()=>{},this.preInited=new Promise(e=>this.activeSupport=e),this.options=t,o.on("logout",()=>this.onLogout()),g().then(async()=>{await this.inited,this.onLogin()}),this.inited=this.preInited.then(()=>this.init(t))}get isOpen(){return this._isOpen}set isOpen(t){this._isOpen=t}onLogout(){}async openLiveSupport(t=!this.isOpen){t&&(o.emit("track_assistance_requested"),await this.getPayment()),this.activeSupport(),this.isOpen=t,await this.inited,this.toggle(t)}sendOrder(t){}async sendLiveSupport(t){this.activeSupport(),await this.inited,this.isOpen||this.toggle(!0),this.sendMsg(t)}}function y(){return p().get("/user/intercom/hash/")}const v=function(){const{isBrHost:t}=u.getHostType(l.host),e=t?"BRLFIAT":"INRFIAT";return p().post("/payment/order/list/",{currencyName:e})};let c=null;class f extends m{constructor(t){super({id:t})}async init(){var t=window,e=function(){e.c(arguments)};e.q=[],e.c=function(s){e.q.push(s)},t.Intercom=e,await u.loadScript(`https://widget.intercom.io/widget/${this.options.id}`),this.exec("onHide",()=>this.isOpen=!1),this.exec("onShow",()=>this.isOpen=!0),this.exec("boot",{hide_default_launcher:!0,app_id:this.options.id,Level:0,language_override:a.lang})}async getPayment(){if(n.login)try{const t=await v(),e=t&&t.length>0;this.exec("update",{verifyINR:e,INRverify:e,INRverify2:e?1:0})}catch(t){console.log(t)}}async onLogin(){const{appId:t,name:e,userId:s,userHash:d}=await y();this.exec("update",{app_id:t,name:`${s}-${e}`,user_name:e,user_id:s,email:"",Level:n.vipLevel,L:n.vipLevel,created_at:Date.now(),user_hash:d,language_override:a.lang,INRverify:!1}),this.isOpen&&this.exec("show")}onLogout(){this.exec("shutdown")}async sendOrder(t){c?.OrderId!==t.OrderId&&(c=t,this.exec("update",t))}sendMsg(t){}async toggle(t){this.exec(t?"show":"hide")}async exec(...t){await this.inited,window.Intercom(...t)}}function w(){const i=(globalThis.location?.host||"").includes("stage")?"i5ulmyr4":"t87ss9s4";return i?new f(String(i)):null}let r=null;function h(){return r||(r=w()),r}async function _(i){return h()?.openLiveSupport(i)}async function S(i){return h()?.sendOrder(i)}export{_ as openLiveSupport,S as sendOrder};
